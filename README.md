# ChessEngine - Шахматный движок на нейронных сетях

Проект представляет собой шахматный движок, использующий предобученную нейронную сеть для оценки позиций и выбора ходов. Реализован протокол UCI для взаимодействия с графическими интерфейсами.

## Структура проекта

ChessEngine/

├── src/                   
│   ├── data/              
│   ├── models/            
│   ├── chess_engine.py    
│   ├── main.py            
│   ├── model.py           
│   ├── model_test.ipynb   
│   ├── requirements.txt   
│   └── move_to_int        
├── .venv/                 
└── README.md              

## Файлы и их назначение

### Основные файлы
- **chess_engine.py** - класс `ChessEngine`, реализующий логику оценки позиций
- **main.py** - UCI-интерфейс для взаимодействия с шахматными GUI
- **model.py** - архитектура нейронной сети `ChessModel`
- **requirements.txt** - зависимости Python

### Модели и данные
- **models/weights.pth** - веса обученной модели
- **move_to_int** - словарь для преобразования ходов UCI в числовые индексы
- **data/** - тренировочные данные в формате PGN

## Использование

### Через UCI-интерфейс
```bash
cd src
python3 main.py
```

Поддерживаемые команды:
- `uci` - инициализация протокола
- `isready` - проверка готовности движка
- `position [fen <FEN> | startpos] moves <move1> <move2> ...` - установка позиции
- `go` - расчет лучшего хода
- `quit` - завершение работы

### Ручное тестирование
Запустите `model_test.ipynb` для интерактивного тестирования модели:
- Загрузите модель и словарь ходов
- Установите позицию на доске
- Получите рекомендацию от нейросети
- Проанализируйте распределение вероятностей

## Архитектура модели

Модель использует представление доски в виде 13 слоев 8x8:
- 6 слоев для белых фигур (пешки, кони, слоны, ладьи, ферзь, король)
- 6 слоев для черных фигур
- 1 слой для легальных ходов

## Зависимости

Основные зависимости:
- python-chess==1.10.0
- torch==2.0.0
- numpy==1.24.0
- ipython==8.14.0 (для model_test.ipynb)

### Авторы: Мария Мечетная, Полина Бганцова, Карина Мархиева
